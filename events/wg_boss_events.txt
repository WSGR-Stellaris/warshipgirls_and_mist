namespace = wg_boss

#######################################
# 利维坦
#######################################
event = {
	id = wg_boss.1
	hide_window = yes
	is_triggered_only = yes
	fire_only_once = yes
	trigger = {
		any_country = {
			OR = {
				has_authority = auth_warshipgirls
				has_authority = auth_shenhai
			}
			is_ai = no
		}
		NOT = { has_global_flag = wg_boss_created }
	}	
	immediate = {
		random_country = {
			limit = {
				OR = {
					has_authority = auth_warshipgirls
					has_authority = auth_shenhai
				}
				is_ai = no
			}		
			country_event = { id = wg_boss.19 }
		}	
		random_list = { 
			70 = {
				random_country = {
					limit = {
						OR = {
							has_authority = auth_warshipgirls
							has_authority = auth_shenhai
						}
						is_ai = no
					}
					country_event = { id = wg_boss.2 }
				}
			}
			30 = {
			}
		}
	}
}
country_event = {
	id = wg_boss.2
	hide_window = yes
	is_triggered_only = yes
	fire_only_once = yes
	trigger = {
		NOT = { has_global_flag = wg_boss_created }
	}	

	immediate = {
		set_global_flag = wg_boss_created
		capital_scope = {
			spawn_system = {
				hyperlane = yes
				min_steps = 10
				max_steps = 20
				initializer = wg_boss_think_tank_system
			}
		}
	}
}

country_event = {
	id = wg_boss.3
	hide_window = yes
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		is_country_type = guardian_wg_think_tank
		has_country_flag = guardian_wsg_think_tank_country_flag
		FROMFROM = { is_ship_size = wg_think_tank }
		FROM = { is_ai = no }
	}
	
	immediate = {
		set_global_flag = no_guardian_wg_think_tank
		FROMFROM = {
			solar_system = {
				spawn_megastructure = {
					name = "NAME_WG_THINK_TANK_RUINED"
					type = "think_tank_ruined"
					random_pos = yes
					orbit_angle = 360	
				}
			}
		}
		FROM = {
			country_event = { id = wg_boss.4 days = 5 }
		}
		destroy_country = yes
	}
}

country_event = {
	id = wg_boss.4
	title = wg_boss.4.name
	desc = wg_boss.4.desc
	picture = GFX_evt_large_explosion
	location = root

	is_triggered_only = yes

	option = {
		name = wg_boss.4.a
		add_modifier = {
			modifier = "wsg_think_tank_destoryed" 	
			days = -1
		}		
	}
}

ship_event = {
	id = wg_boss.5
	title = "wg_boss.5.name"
	desc = "wg_boss.5.desc"

	is_triggered_only = yes
	picture = GFX_evt_think_tank

	trigger = {
		FROM = {
			has_star_flag = wg_boss_think_tank_system_home
		}
		FROMFROM = {
			is_ai = no
			NOT = { has_country_flag = triggered_wg_think_tank_event }
		}
	}

	immediate = {
		FROMFROM = {
			set_country_flag = triggered_wg_think_tank_event
		}
	}

	option = {
		name = "wg_boss.5.a"
		hidden_effect = {
			owner = {
				if = {
					limit = { 
						OR = { 
							has_authority = auth_warshipgirls
							has_authority = auth_shenhai
						}
						is_ai = no
					}
					country_event = { id = wg_boss.15 days = 360 random = 360 }
				}
			}			
		}		
	}
}

country_event = {
	id = wg_boss.6
	title = "wg_boss.6.name"
	desc = "wg_boss.6.desc"
	picture = GFX_evt_think_tank
	location = FROM
	trackable = yes

	is_triggered_only = yes
	immediate = {
		random_country = {
			limit = { is_country_type = guardian_wg_think_tank }
			random_owned_fleet = {
				limit = { has_fleet_flag = wsg_think_tank_fleet }
				save_event_target_as = wg_think_tank_location
			}
		}
	}
	option = {
		name = "wg_boss.6.a"
		enable_special_project = {
			name = "THINK_TANK_FTL_PROJECT"
			location = event_target:wg_think_tank_location
		}
		hidden_effect = {
			set_country_flag = astesia_helper			
		}		
	}
}

country_event = {
	id = wg_boss.7
	title = "wg_boss.7.name"
	desc = "wg_boss.7.desc"
	picture = GFX_evt_think_tank
	location = FROM
	trackable = yes

	is_triggered_only = yes
	immediate = {
		random_country = {
			limit = { is_country_type = guardian_wg_think_tank }
			random_owned_fleet = {
				limit = { has_fleet_flag = wsg_think_tank_fleet }
				save_event_target_as = wg_think_tank_location
			}
		}
	}
	option = {
		name = "wg_boss.7.a"
			enable_special_project = {
				name = "THINK_TANK_FTL_PROJECT2"
				location = event_target:wg_think_tank_location
		}
	}
}

country_event = {
	id = wg_boss.8
	title = wg_boss.8.name
	desc = wg_boss.8.desc
	picture = GFX_evt_large_explosion
	location = from
	
	is_triggered_only = yes
	
	option = {
		name = wg_boss.8.a
		custom_tooltip = wg_boss.8.tooltip
		add_modifier = {
			modifier = "wsg_think_tank_destoryed" 	
			days = -1
		}
		owner = {
			add_resource = { alloys = 5000 }
		}
		hidden_effect = {
			random_country = {
				limit = { is_country_type = guardian_wg_think_tank }
				random_owned_fleet = {
					limit = { has_fleet_flag = wsg_think_tank_fleet }
					delete_fleet = this
				}
				destroy_country = yes
			}
		}				
	}
}

country_event = {
	id = wg_boss.9
	title = wg_boss.9.name
	desc = wg_boss.9.desc
	picture = GFX_evt_think_tank
	location = from
	
	is_triggered_only = yes
	
	option = {
		name = wg_boss.9.a
		custom_tooltip = wg_boss.9.tooltip
		hidden_effect = {
			random_country = {
				limit = { is_country_type = guardian_wg_think_tank }
				random_owned_fleet = {
					limit = { has_fleet_flag = wsg_think_tank_fleet }
					delete_fleet = this
				}
				destroy_country = yes
			}
			every_country = {
				limit = {
					has_country_flag = astesia_helper
					has_modifier = wsg_Astesia
				}
				remove_modifier = "wsg_Astesia"	
			}			
			random_list = {
				60 = { country_event = { id = wg_boss.11 days = 10 random = 10 } }
				40 = { country_event = { id = wg_boss.10 days = 10 random = 90 } }
			}			
		}				
	}
}

country_event = {
	id = wg_boss.10
	title = wg_boss.10.name
	desc = wg_boss.10.desc
	picture = GFX_evt_space_debris
	location = from
	
	is_triggered_only = yes
	
	option = {
		name = wg_boss.10.a
		add_modifier = {
			modifier = "wsg_think_tank_destoryed2" 	
			days = -1
		}				
	}
}

country_event = {
	id = wg_boss.11
	title = wg_boss.11.name
	desc = wg_boss.11.desc
	picture = GFX_evt_think_tank
	show_sound = event_construction
	location = event_target:wg_capital
	
	is_triggered_only = yes
	
	immediate = {
		owner = {
			save_event_target_as = wg_project_owner
		}
		capital_scope = { save_event_target_as = wg_capital }
	}
	
	option = {
		name = "wg_boss.11.a"
		add_modifier = {
			modifier = "wsg_Astesia2" 	
			days = -1
		}		
		create_fleet = {
			name = "NAME_Astesia"
			effect = {
				set_owner = event_target:wg_project_owner
				create_ship = {
					name = random
					design = "NAME_WG_THINK_TANK"
					upgradable = no
				}
				set_location = {
					target = event_target:wg_capital
					distance = 0
					angle = random
				}
				add_modifier = {
					modifier = wsg_think_tank_power2
					days = -1
				}
				set_fleet_flag = astesia_back_home				
			}
		}
		hidden_effect = {
			owner = {
				country_event = { id = wg_boss.12 days = 1800 random = 1800 }
			}			
		}
	}	
}
country_event = {
	id = wg_boss.12
	title = "wg_boss.12.name"
	desc = "wg_boss.12.desc"
	picture = GFX_evt_engineering_research
	is_triggered_only = yes

	trigger = {
	    any_country = {
			has_country_flag = astesia_chosen_one
			any_owned_ship = { is_ship_size = wg_think_tank }
		}
	}	
		
	option = {
		name = "wg_boss.12.a"
		owner={
			give_technology = { tech = tech_boss_weapen_ion }
		}		
	}	
}
country_event = {
	id = wg_boss.13
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				has_country_flag = astesia_helper
				NOT = { has_modifier = wsg_Astesia }
		}
		add_modifier = {
			modifier = wsg_Astesia
				days = -1
			}	
		}		
	}			
}

country_event = {
	id = wg_boss.14
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				has_country_flag = astesia_helper
				has_modifier = wsg_Astesia
			}
			remove_modifier = "wsg_Astesia"	
		}		
	}			
}
#极光看中的人，仅此一个
country_event = {
	id = wg_boss.15
	title = "wg_boss.15.name"
	desc = "wg_boss.15.desc"
	picture = GFX_evt_wsg_no_video
	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = {
		NOT = { has_global_flag = no_guardian_wg_think_tank }
	}		
	option = {
		name = "wg_boss.15.a"
		hidden_effect = {
			set_country_flag = astesia_chosen_one
			owner = {
				country_event = { id = wg_boss.16 }
			}			
		}		
	}	
}

country_event = {
	id = wg_boss.16
	title = "wg_boss.16.name"
	desc = "wg_boss.16.desc"
	show_sound = event_administrative_work
	location = from.from.from

	picture_event_data = {
		room = no_video_feed_room
	}
	diplomatic = yes
	force_open = yes

	is_triggered_only = yes
	immediate = {
		set_country_flag = eddy_flag
	}
	option = {
		name = wg_boss.16.a
		response_text = wg_boss.16.a.response
		is_dialog_only = yes
	}
	option = {
		name = wg_boss.16.b
		response_text = wg_boss.16.b.response
		is_dialog_only = yes
	}
	option = {
		name = wg_boss.16.c
		hidden_effect = {
			country_event = { id = wg_boss.17 }
		}
	}
}

country_event = {
	id = wg_boss.17
	title = "wg_boss.17.name"
	desc = "wg_boss.17.desc"
	show_sound = event_administrative_work
	location = from.from.from

	picture_event_data = {
		room = no_video_feed_room
	}
	diplomatic = yes
	force_open = yes

	is_triggered_only = yes

	option = {
		name = wg_boss.17.a
		response_text = wg_boss.17.a.response
		is_dialog_only = yes
	}
	option = {
		name = wg_boss.17.b
		hidden_effect = {
			country_event = { id = wg_boss.6 }
		}
	}
	option = {
		name = wg_boss.17.c
		hidden_effect = {
			country_event = { id = wg_boss.7 }
		}
	}
	option = {
		name = wg_boss.17.d
		hidden_effect = {
			country_event = { id = wg_boss.18 }
		}
	}
}

country_event = {
	id = wg_boss.18
	title = "wg_boss.18.name"
	desc = "wg_boss.18.desc"
	show_sound = event_administrative_work
	location = from.from.from

	picture_event_data = {
		room = no_video_feed_room
	}
	diplomatic = yes
	force_open = yes

	is_triggered_only = yes

	option = {
		name = wg_boss.18.a
	}
}
#############无人机之主
country_event = {
	id = wg_boss.19
	hide_window = yes
	is_triggered_only = yes
	fire_only_once = yes
	trigger = {
		NOT = { has_global_flag = wg_boss_uav_created }
	}	

	immediate = {
		set_global_flag = wg_boss_uav_created
		capital_scope = {
			spawn_system = {
				hyperlane = yes
				min_steps = 15
				max_steps = 25
				initializer = wg_boss_uav_system
			}
		}
	}
}
ship_event = {
	id = wg_boss.20
	title = "wg_boss.20.name"
	desc = "wg_boss.20.desc"
	is_triggered_only = yes
	picture = GFX_evt_ruined_system
	fire_only_once = yes

	trigger = {
		FROM = {
			has_star_flag = wg_boss_uav_system_home
		}
		FROMFROM = {
			NOT = { has_country_flag = triggered_wg_boss_uav_event }
		}
	}

	immediate = {
		solar_system = {
			random_system_ambient_object = {
				limit = { has_ambient_object_flag = hidden_uav_1 }
				save_event_target_as = hidden_uav_1_location
			}
			random_system_ambient_object = {
				limit = { has_ambient_object_flag = hidden_uav_2 }
				save_event_target_as = hidden_uav_2_location
			}
			random_system_ambient_object = {
				limit = { has_ambient_object_flag = hidden_uav_boss }
				save_event_target_as = hidden_uav_boss_location
			}	
		}	
		FROMFROM = {
			set_country_flag = triggered_wg_boss_uav_event
		}		
	}

	option = {
		name = "wg_boss.20.a"
		hidden_effect = {
			owner = {
				country_event = { id = wg_boss.21 days = 15 random = 15 }	
			}	
		}		
	}
}

country_event = {
	id = wg_boss.21
	title = wg_boss.21.name
	desc = wg_boss.21.desc
	picture = GFX_evt_unidentified_ship
	show_sound = event_red_alert
	location = from
	
	is_triggered_only = yes
	fire_only_once = yes
	
	immediate = {	
		create_country = {
			name = "NAME_wg_uav_country"
			type = faction
			flag = {
                icon = {
                    category = "special"
                    file = "gray_goo.dds"
                }
                background= {
                    category = "backgrounds"
                    file = "circle.dds"
                }
                colors={
                    "black"
                    "black"
                    "null"
                    "null"
                }
            }			
			effect = {
				establish_communications_no_message = root.owner
				save_global_event_target_as = wg_uav_country
				set_country_flag = wg_uav_fleet_country_flag
			}
		}		
		create_fleet = {
			name = "NAME_uav_fleet1"
			settings = {
				spawn_debris = no
			}				
			effect = {
				set_owner = event_target:wg_uav_country
				while = {
					count = 10
					create_ship = {
						name = random
						design = "NAME_WG_LARGE_UAV"
					}
				}
				while = {
					count = 30
					create_ship = {
						name = random
						design = "NAME_WG_MEDIUM_UAV"
					}
				}	
				while = {
					count = 47
					create_ship = {
						name = random
						design = "NAME_WG_SMALL_UAV"
					}
				}				
				set_location = {
					target = event_target:hidden_uav_1_location
					distance = 10
					angle = 0
				}
				add_modifier = {
					modifier = wsg_boss_uav_power
					days = -1
				}				
			}
		}
		create_fleet = {
			name = "NAME_uav_fleet2"
			settings = {
				spawn_debris = no
			}			
			effect = {
				set_owner = event_target:wg_uav_country
				while = {
					count = 10
					create_ship = {
						name = random
						design = "NAME_WG_LARGE_UAV"
					}
				}
				while = {
					count = 30
					create_ship = {
						name = random
						design = "NAME_WG_MEDIUM_UAV"
					}
				}	
				while = {
					count = 47
					create_ship = {
						name = random
						design = "NAME_WG_SMALL_UAV"
					}
				}				
				set_location = {
					target = event_target:hidden_uav_2_location
					distance = 10
					angle = 0
				}
				add_modifier = {
					modifier = wsg_boss_uav_power
					days = -1
				}				
			}
		}
		create_fleet = {
			name = "NAME_uav_fleet3"
			settings = {
				spawn_debris = no
				is_boss = yes
			}			
			effect = {
				set_owner = event_target:wg_uav_country
				while = {
					count = 1
					create_ship = {
						name = "NAME_FLETCHER"
						design = "NAME_WG_FLETCHER"
					}
				}				
				set_location = {
					target = event_target:hidden_uav_boss_location
					distance = 10
					angle = 0
				}
				add_modifier = {
					modifier = wsg_boss_uav_power2
					days = -1
				}
				set_fleet_flag = wg_uav_boss_flag				
			}
		}		
	}
	
	option = {
		name = "wg_boss.21.a"
	}	
}	

country_event = {
	id = wg_boss.22
	title = wg_boss.22.name
	desc = wg_boss.22.desc
	picture = GFX_evt_small_space_battle
	location = from
	
	is_triggered_only = yes
	
    option = {
		name = wg_boss.22.a
        trigger = { 
            OR = {
                has_authority = auth_shenhai
                has_authority = auth_warshipgirls
            }
			NOT = { has_technology = tech_uav4 }
        }
		owner={
			add_research_option = "tech_uav4"
			add_tech_progress = {
				tech = tech_uav4
				progress = 0.50
			}
		}		
	}
    option = {
		name = wg_boss.22.a
        trigger = { 
            OR = {
                has_authority = auth_shenhai
                has_authority = auth_warshipgirls
            }
			has_technology = tech_uav4
        }
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier5researchreward
				min = @tier5researchmin
				max = @tier5researchmax
			}
		}		
	}
	option = {
		name = wg_boss.22.a
        trigger = { 
            NOR = {
                has_authority = auth_shenhai
                has_authority = auth_warshipgirls
            }
        }
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier5researchreward
				min = @tier5researchmin
				max = @tier5researchmax
			}
		}		
	}	
}

country_event = {
	id = wg_boss.23
	hide_window = yes
	
	is_triggered_only = yes
	trigger = {
		fromfrom = { 
			has_fleet_flag = wg_uav_boss_flag
		}
	}
	immediate = {
		every_country = {
			limit = {
				has_country_flag = wg_uav_fleet_country_flag
			}
			destroy_country = yes	
		}
	}	
    option = {
		From = {
			country_event = { id = wg_boss.22 days = 5 }
		}	
	}	
}